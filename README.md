# LOLGameMate

作者: mkx
日期: 2025-09-16

## 简介
一个 Windows 游戏助手，使用DD驱动实现底层输入控制：
- 全局热键（默认 Ctrl+Alt+Q，可自定义）
- 简单 UI 配置用户名/密码
- 内置DD驱动支持，自动加载项目内置的dd.54900.dll
- 凭证安全存储（DPAPI 加密，用户作用域）

## 使用
1. 启动程序，在主界面输入用户名与密码，点击"保存"。
2. 程序会自动加载内置的DD驱动库，无需手动配置
3. 可通过"设置热键"按钮自定义热键组合（默认 Ctrl+Alt+Q）
4. 切到目标客户端登录界面，按设置的热键，程序会：
   - 延迟1秒（给用户时间切换窗口）
   - 自动输入：用户名 -> Tab -> 密码 -> Enter

## DD 驱动说明
- DD 驱动模式使用第三方 dd.54900.dll 库实现底层键鼠控制
- 项目Lib目录已包含dd.54900.dll文件，程序启动时会自动加载
- 如果自动加载失败，可通过"选择..."按钮手动选择DD库文件
- 支持的 DD 码映射：Tab(300), Enter(284), A-Z(401-426) 等
- 使用前请确保遵守相关软件的使用条款和法律法规

## 热键设置功能

### 默认热键
- 默认热键组合：**Ctrl+Alt+Q**
- 可通过主界面的"设置热键"按钮进行修改

### 自定义热键
1. 点击主界面的"设置热键"按钮
2. 在热键设置对话框中：
   - 使用"捕获热键"功能：点击按钮后按下想要的热键组合
   - 手动选择修饰键：勾选 Ctrl、Alt、Shift、Win 等修饰键
   - 查看当前设置的热键组合和主键
3. 系统会自动检测热键冲突，防止设置已被占用的热键
4. 点击"确定"保存设置，新热键立即生效
5. 配置会自动保存到本地，程序重启后保持设置

### 热键冲突检测
- 自动检测系统保留热键（如 Ctrl+Alt+Del、Alt+Tab 等）
- 检测与其他应用程序的热键冲突
- 提供友好的错误提示和建议

## 安全与合规声明
本项目提供了可插拔的输入架构，用户可根据需要选择不同的输入实现。使用任何第三方驱动时，请自行承担合规和法律责任。

## 结构
- Services/HotkeyManager.cs：全局热键管理器（支持动态热键注册）
- Services/HotkeyConfigService.cs：热键配置存储服务
- Models/HotkeyConfig.cs：热键配置模型类
- Input/KeyboardMouse.cs：DD驱动输入封装
- Input/Providers/DDInputProvider.cs：DD 驱动输入提供器
- Input/Providers/DDWrapper.cs：DD 库封装器
- Security/CredentialStore.cs：凭证存储（DPAPI）
- Form1：主界面及接线
- HotkeySettingsForm：热键设置对话框

## 编译
使用 .NET 8 WinForms，直接构建运行即可：
```
dotnet build
```

## 功能特性
- **DD驱动输入**：使用DD驱动实现底层输入控制，内置库文件
- **安全存储**：使用 Windows DPAPI 加密存储凭证
- **自定义热键**：支持热键自定义，配置持久化保存
- **热键冲突检测**：自动检测并防止热键冲突
- **全局热键**：支持系统级热键注册和动态更改
- **简洁 UI**：直观的配置界面和热键设置对话框
- **防重复机制**：1秒内防抖，避免重复触发
- **执行状态保护**：确保同时只有一个登录操作执行
- **自动初始化**：程序启动时自动加载DD库，无需手动配置

## 更新日志
### 2025-09-16
- ✅ 修复热键重复触发问题：添加1秒防抖机制
- ✅ 修复DD模式鼠标卡住问题：优化延时设置和初始化流程
- ✅ 修复重复输入问题：添加执行状态锁定机制
- ✅ 优化用户体验：增加输入验证和状态提示
- ✅ **新增热键自定义功能**：
  - 默认热键更改为 Ctrl+Alt+Q
  - 支持热键自定义设置，提供友好的设置界面
  - 实现热键捕获功能，支持手动选择修饰键
  - 添加热键冲突检测，防止设置已被占用的热键
  - 热键配置持久化保存，程序重启后保持设置
  - 扩展HotkeyManager支持动态热键注册/注销
- ✅ **优化用户体验**：
  - 热键触发后增加1秒延迟，给用户时间切换到目标窗口
  - 自动加载项目Lib目录下的DD库文件，无需手动选择
  - 优化输入间隔时间，提高输入稳定性
- ✅ **简化架构**：
  - 移除SendKeys输入方式，统一使用DD驱动
  - 删除输入模式选择UI，简化用户界面
  - 内置DD库文件，程序启动时自动初始化